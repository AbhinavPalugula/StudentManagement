<!DOCTYPE html>
<html>
<head>
<title>Student Management Application</title>
<meta charset='utf-8'/>
<link rel="stylesheet" href="jquerym.css">
<link rel="stylesheet" href="listview-grid.css">
<script src="jquery.js" type="text/javascript"></script>
<script src="jquerym.js" type="text/javascript"></script>
<script src="fastclick.js" type="text/javascript"></script>

<script src="cordova.js" type="text/javascript"></script>
<style>.ui-header .ui-title, .ui-footer .ui-title {margin-right: 0 !important; margin-left: 0 !important;}
marker {max-width: 100%; max-height: 100%;}
</style>
</head>
<body><div id="pgMenu" data-role="page" data-theme="b" class="my-page">

<header id="pgMenuheader" data-role="header" data-position="fixed">
<h1>Student Management Application</h1>
</header>
<div id="pgMenucontent" data-role="content" class="content">
<ul data-role="listview" data-inset="true" id="sbItems">
<li data-icon="false"><a data-transition="slide" id="sbNote" href="#pgData"><h2>Manage Students</h2><p style="font-size:12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add, Edit, Search, Delete</p></a></li>
</ul>
</div>

<footer id="pgMenufooter" data-role="footer" data-position="fixed">
<h1>Implemented by Students of Pallavi Model School, 8th Class</h1>
</footer></div>
<div id="pgData" data-role="page">

<header id="pgDataheader" data-role="header" data-position="fixed">
<h1>Manage Students</h1>
<a data-role="button" id="pgDataBack" data-icon="arrow-l" class="ui-btn-left">Back</a>
<a data-role="button" id="pgDataNew" data-icon="plus" data-theme="b" class="ui-btn-right">New</a>
</header>
<div id="pgDatacontent" data-role="content" class="content">
<ul data-role="listview" data-inset="true" id="pgDataList" data-autodividers="true" data-filter="true" data-filter-placeholder="Search Students" data-filter-reveal="false">
<li data-role="list-divider">DataHdr</li>
<li id="noData">No students found</li>

</ul>
</div>

</div>

<div id="pgaddData" data-role="page">

<header id="pgaddDataheader" data-role="header" data-position="fixed">
<h1>Add Student</h1>
<a data-role="button" id="pgaddDataBack" data-icon="arrow-l" class="ui-btn-left">Back</a>
</header>
<div id="pgaddDatacontent" data-role="content" class="content">
<form action="#" method="post" id="pgaddDataForm" name="pgaddDataForm">
<div data-role="fieldcontain">
<label for="pgaddDataTitle" id="lblpgaddDataTitle">Title<span style='color:red;'>*</span></label>
<input type="text" required="required" title="Enter student name." name="pgaddDataTitle" id="pgaddDataTitle" placeholder="Enter student name." autocomplete="off" data-clear-btn="true"></input>
</div>
<div data-role="fieldcontain">
<label for="pgaddDataClass" id="lblpgaddDataClass">Class<span style='color:red;'>*</span></label>
<input type="text" required="required" title="Enter Class" name="pgaddDataClass" id="pgaddDataClass" placeholder="Enter Class." autocomplete="off" data-clear-btn="true"></input>
</div>
<div data-role="fieldcontain">
<label for="pgaddDataAddress" id="lblpgaddDataAddress">Address<span style='color:red;'>*</span></label>
<input type="text" required="required" title="Enter Address" name="pgaddDataAddress" id="pgaddDataAddress" placeholder="Enter Address." autocomplete="off" data-clear-btn="true"></input>
</div>
<div data-role="fieldcontain">
<label for="pgaddDataDetail" id="lblpgaddDataDetail">Details<span style='color:red;'>*</span></label>
<textarea name="pgaddDataDetail" id="pgaddDataDetail" placeholder="Enter details here." data-clear-btn="true" required="required"></textarea>
</div>
<div><button type="submit" id="pgaddDataSave" class="ui-btn ui-corner-all ui-shadow ui-btn-b">Save Student Information</button>
</div>
</form>
</div>

</div>

<div data-url="Title" id="pgEditData" data-role="page">

<header id="pgEditDataheader" data-role="header" data-position="fixed">
<h1>Edit Student</h1>
<a data-role="button" id="pgEditDataBack" data-icon="arrow-l" class="ui-btn-left">Back</a>
<a data-role="button" data-href="ID" id="pgEditDataDelete" data-icon="delete" data-theme="b" class="ui-btn-right">Delete</a>
</header>
<div id="pgEditDatacontent" data-role="content" class="content">
<form action="#" method="post" id="pgEditDataForm" name="pgEditDataForm">
<div data-role="fieldcontain">
<label for="pgEditDataTitle" id="lblpgEditDataTitle">Title<span style='color:red;'>*</span></label>
<input readonly="readonly" data-clear-btn="true" autofocus="true" type="text" required="required" title="Enter title here." name="pgEditDataTitle" id="pgEditDataTitle" placeholder="Enter title here." autocomplete="off"></input>
</div>
<div data-role="fieldcontain">
<label for="pgEditDataClass" id="lblpgEditDataClass">Class<span style='color:red;'>*</span></label>
<input data-clear-btn="true" type="text" required="required" title="Enter Class" name="pgEditDataClass" id="pgEditDataClass" placeholder="Enter Class" autocomplete="off"></input>
</div>
<div data-role="fieldcontain">
<label for="pgEditDataAddress" id="lblpgEditDataAddress">Class<span style='color:red;'>*</span></label>
<input data-clear-btn="true" type="text" required="required" title="Enter Class" name="pgEditDataAddress" id="pgEditDataAddress" placeholder="Enter Class" autocomplete="off"></input>
</div>
<div data-role="fieldcontain">
<label for="pgEditDataDetail" id="lblpgEditDataDetail">Details<span style='color:red;'>*</span></label>
<textarea name="pgEditDataDetail" id="pgEditDataDetail" placeholder="Enter details here." data-clear-btn="true" required="required"></textarea>
</div>
<div><button type="submit" id="pgEditDataUpdate" class="ui-btn ui-corner-all ui-shadow ui-btn-b">Update Student</button>
</div>
</form>
</div>

</div>
<section data-transition="pop" id="msgbox" data-role="dialog">

<header id="msgboxheader" data-role="header" data-position="fixed">
<h1>Confirm</h1>
</header>
<div id="msgboxcontent" data-role="content" class="content">
<div id="msgboxtitle">
</div>
<br><div id="msgboxprompt">
<p>Are you sure you want to delete this student?</p>
</div>
<br><div style="text-align: center;" id="msgboxbuttons" class="ui-grid-a">
<div class="ui-block-a">
<a data-method="" data-id="" data-topage="" id="msgboxyes" data-role="button" data-icon="check">Yes</a>
</div>
<div class="ui-block-b">
<a data-method="" data-id="" data-topage="" id="msgboxno" data-role="button" data-icon="delete" data-theme="b">No</a>
</div>
</div>
</div>

</section>
<section data-transition="pop" id="alertbox" data-role="dialog">

<header id="alertboxheader" data-role="header" data-position="fixed">
<h1>Error</h1>
</header>
<div id="alertboxcontent" data-role="content" class="content">
<div id="alertboxtitle">
</div>
<br><div id="alertboxprompt">
<p>An error has been encountered!</p>
</div>
<br><div style="text-align: center;" id="alertboxbuttons" class="ui-grid-solo">
<div class="ui-block-a">
<a data-method="" data-id="" data-topage="" id="alertboxok" data-role="button" data-icon="check" data-theme="b">Ok</a>
</div>
</div>
</div>

</section>
<script>
$(function(){
// define the application
var DataManager = {};
var pictureSource;
var destinationType;
var isPhoneGapReady = false;
(function(app){
// variable definitions go here
var DataLi = '<li ><a href="#pgEditData?Title=LINK">ID</a></li>';
var DataHdr = '<li data-role="list-divider">DataHdr</li>';
var noData = '<li id="noData">No students found</li>';


app.init = function(){
FastClick.attach(document.body);
app.databindings();
app.checkForStorage();
app.BindDevice();

//Delete confirmation
$('#msgboxyes').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var yesmethod = $('#msgboxyes').data('method');
var yesid = $('#msgboxyes').data('id');
app[yesmethod](yesid);
});

$('#msgboxno').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var toPage = $('#msgboxno').data('topage');
// show the page to display after a record is deleted
$.mobile.changePage('#'+toPage, {transition: 'slide'});
});

$('#alertboxok').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var toPage = $('#alertboxok').data('topage');
// show the page to display after ok is clicked
$.mobile.changePage('#'+toPage, {transition: 'slide'});
});

$(document).on('click', '#sbItems a', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var href = $(this).attr('href');
$.mobile.changePage(href, {transition: 'slide'});
});

};

app.databindings = function(){
$(document).on('click', '#pgDataList a', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var href = $(this)[0].href.match(/\?.*$/)[0];
var Title = href.replace(/^\?Title=/,'');
$.mobile.changePage('#pgEditData', {transition: 'slide'});
app.editData(Title);
});

$(document).on('pagebeforechange', function(e, data){
var toPage = data.toPage[0].id;
if(toPage == 'pgData'){
// restart the storage check
app.checkForStorage();
}
});

// bind the back button of the list
$('#pgDataBack').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
// move to the add new record screen
$.mobile.changePage('#pgMenu', {transition: 'slide'});
});
// click new on listing page
$('#pgDataNew').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
$('#pgaddData').data('from', pgData);
// move to the add new record screen
$.mobile.changePage('#pgaddData', {transition: 'slide'});
});
// click back button of new record page
$('#pgaddDataBack').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
//which page are we coming from, if from sign in go back to it
var pgFrom = $('#pgaddData').data('from');
switch (pgFrom) {
case "pgSignIn":
$.mobile.changePage('#pgSignIn', {transition: 'slide'});
break;
default:
// go back to the listing screen
$.mobile.changePage('#pgData', {transition: 'slide'});
}
});
// click save button of new record
$('#pgaddDataSave').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
// save the Data
var DataRec;
DataRec = pgaddDataGetRec();
app.addData(DataRec);
});
// click back button of edit record page
$('#pgEditDataBack').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
// go back to the listing screen
$.mobile.changePage('#pgData', {transition: 'slide'});
});
// click update when editing a record
$('#pgEditDataUpdate').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
// save the Note
var DataRecNew;
DataRecNew = pgEditDataGetRec();
app.updateData(DataRecNew);
});
// click delete on edit page
$('#pgEditDataDelete').on('click', function(e){
e.preventDefault();
e.stopImmediatePropagation();
var Title = $('#pgEditDataTitle').val();
Title = Title.replace(/-/g,' ');
Title = Title.replace(/-/g,' ');
$('#msgboxheader h1').text('Confirm Delete');
$('#msgboxtitle').text(Title);
$('#msgboxprompt').text('Are you sure that you want to delete this student?');
$('#msgboxyes').data('method', 'deleteData');
Title = Title.replace(/ /g,'-');
$('#msgboxyes').data('id', Title);
$('#msgboxno').data('topage', 'pgEditData');
$.mobile.changePage('#msgbox', {transition: 'pop'});

});





};
//get the record to be saved and put it in a record array
function pgaddDataGetRec(){
//define the new record
var DataRec
DataRec = {};
DataRec.Title = $('#pgaddDataTitle').val();
DataRec.Class = $('#pgaddDataClass').val();
DataRec.Address = $('#pgaddDataAddress').val();
DataRec.Detail = $('#pgaddDataDetail').val();
return DataRec;
}

//get the record to be saved and put it in a record array
function pgEditDataGetRec(){
//define the new record
var DataRec
DataRec = {};
DataRec.Title = $('#pgEditDataTitle').val();
DataRec.Class = $('#pgEditDataClass').val();
DataRec.Address = $('#pgEditDataAddress').val();
DataRec.Detail = $('#pgEditDataDetail').val();
return DataRec;
}

//clear the forms for new data entry
function pgAddDataClear(){
$('#pgaddDataTitle').val('');
$('#pgaddDataClass').val('');
$('#pgaddDataAddress').val('');
$('#pgaddDataDetail').val('');
}

//clear the forms for new data entry
function pgEditDataClear(){
$('#pgEditDataTitle').val('');
$('#pgEditDataClass').val('');
$('#pgEditDataAddress').val('');
$('#pgEditDataDetail').val('');
}





app.addData = function(DataRec){
// get Note records.
var DataObj = app.getData();
// define a record object to store the current details
var Title = DataRec.Title;
Title = Title.replace(/ /g,'-');
DataObj[Title] = DataRec;
localStorage['local-data-json'] = JSON.stringify(DataObj);
// clear the form fields
pgAddDataClear();
//which page are we coming from, if from sign in go back to it
var pgFrom = $('#pgaddData').data('from');
switch (pgFrom) {
case "pgSignIn":
$.mobile.changePage('#pgSignIn', {transition: 'slide'});
break;
}
};

app.editData = function(Title){
// get Note records.
var DataObj = app.getData();
// lookup specific Note
Title = Title.replace(/ /g,'-');
var DataRec = DataObj[Title];
$('#pgEditData').data('url', Title);
$('#pgEditDataDelete').data('href', Title);
$('#pgEditDataTitle').attr('readonly', 'readonly');
$('#pgEditDataTitle').attr('data-clear-btn', 'false');
$('#pgEditDataTitle').val(DataRec.Title);
$('#pgEditDataClass').val(DataRec.Class);
$('#pgEditDataAddress').val(DataRec.Address);
$('#pgEditDataDetail').val(DataRec.Detail);
};

app.updateData = function(DataRecNew){
// get Note records.
var DataObj = app.getData();
// lookup specific Note
var Title = DataRecNew.Title;
Title = Title.replace(/ /g,'-');
var DataRec = DataObj[Title];
// assign new values to read record
DataRec.Title = DataRecNew.Title;
DataRec.Class = DataRecNew.Class;
DataRec.Address = DataRecNew.Address;
DataRec.Detail = DataRecNew.Detail;
DataObj[Title] = DataRec;
localStorage['local-data-json'] = JSON.stringify(DataObj);
// clear the form fields
pgEditDataClear();
// show the page to display after a record is deleted
$.mobile.changePage('#pgData', {transition: 'slide'});
};

app.deleteData = function(Title){
// clear the set values// get the Note records from localStorage
var DataObj = app.getData();
// delete selected Note
delete DataObj[Title];
// write it back to localStorage
localStorage['local-data-json'] = JSON.stringify(DataObj);
// show the page to display after a record is deleted
$.mobile.changePage('#pgData', {transition: 'slide'});
};

app.getData = function(){
// get Note records
var DataObj = localStorage['local-data-json'];
if (!DataObj){
DataObj = {};
localStorage['local-data-json'] = JSON.stringify(DataObj);
} else {
DataObj = JSON.parse(DataObj);
}
return DataObj;
};

app.displayData = function(){
// get Note records.
var DataObj = app.getData();
// create an empty string to contain html
var html = '';
// make sure your iterators are properly scoped
var n;
// loop over notes
for (n in DataObj){
var nLnk = n.replace(/-/g,' ');
html += DataLi.replace(/ID/g,nLnk).replace(/LINK/g,n);
}
$('#pgDataList').html(DataHdr + html).listview('refresh');
};

app.checkForStorage = function(){
var DataObj = app.getData();
// are there existing Note records?
if (!$.isEmptyObject(DataObj)) {
// yes there are. pass them off to be displayed
app.displayData();
} else {
// nope, just show the placeholder
$('#pgDataList').html(DataHdr + noData).listview('refresh');
}
};

app.BindDevice = function(){
document.addEventListener('deviceready', app.onDeviceReady, false);
};

app.onDeviceReady = function(){
pictureSource = navigator.camera.PictureSourceType;
destinationType = navigator.camera.DestinationType;
isPhoneGapReady = true;
};


app.init();
})(DataManager);
});

</script>
</body>
</html>
